var a=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;import{a as o}from"./uni-search-bar.35222574.js";import{_ as n,D as s,E as i,a as c,c as u,Q as m,o as d,d as f,w as p,e as h,f as g,F as _,K as v,k as b,U as y}from"./vendor.6cfed29b.js";import{g as w,c as j,a as M}from"./subscribe.6d98f777.js";import{m as C,r as D}from"./materialItem.56eaf3b4.js";import"./request.c3c876b8.js";import"./token.f74162db.js";var S=n(s({components:{materialItem:C,reaction:D},onShow:function(){this.getCartList()},setup(){const a=i([]);let o=i(""),n={pageSize:20,pageNum:1};const s=i(0),c=i(!0),u=i([]),m=i({show:!1,materials:[]}),d=()=>{u.value=[],M({s_id:"10"}).then((a=>{u.value=a.data||[]}))};return{materialData:a,scrollTop:s,getMaterialQuery:()=>{if(""==(null!=o?o:""))return void(c.value=!1);const s=((a,o)=>{for(var n in o||(o={}))t.call(o,n)&&l(a,n,o[n]);if(e)for(var n of e(o))r.call(o,n)&&l(a,n,o[n]);return a})({r_g_id:"10",s_id:"10",m_name:o.value},n);c.value&&w(s).then((e=>{const t=e.data.map((a=>{const e=u.value.find((e=>e.m_id===a._id));return console.log(e),a.num=e?e.m_c_count:0,a}));t.length<n.pageSize&&(c.value=!1),a.value=[...a.value,...t],n.pageNum++}))},loading:c,page:n,m_name:o,resetSearch:e=>{o.value=e,c.value=!0,n.pageNum=1,a.value=[]},toCartInsert:a=>{j(a).then((a=>{var e;const t=null==(e=a.data)?void 0:e.r_m_material;t&&t.length>0?m.value={materials:t,show:!0}:m.value={materials:[],show:!1},d()}))},reactionMaterials:m,getCartList:d,cartMaterialList:u}},methods:{lower:function(a){console.log(a),this.getMaterialQuery()},search:function(a){console.log("search"),this.resetSearch(a.value),this.getMaterialQuery()}}}),[["render",function(a,e,t,r,l,n){const s=c(u("uni-search-bar"),o),i=m("material-item"),w=b,j=y,M=m("reaction");return d(),f(w,{class:"shopping-container-search"},{default:p((()=>[h(s,{onConfirm:a.search,radius:"20",maxlength:"30",bgColor:"#fff",placeholder:"请输入物料名称搜索"},null,8,["onConfirm"]),h(w,{class:"shopping-container-main"},{default:p((()=>[a.materialData.length>0?(d(),f(j,{key:0,ref:"materialMod",class:"right scroll-Y materialList","scroll-y":"true","lower-threshold":"50",onScrolltolower:a.lower},{default:p((()=>[h(i,{materialData:a.materialData,onJiaReaction:a.toCartInsert},null,8,["materialData","onJiaReaction"]),h(w,{class:"loading"},{default:p((()=>[g(_(a.loading?"加载中":"到底喽"),1)])),_:1})])),_:1},8,["onScrolltolower"])):""==a.m_name?(d(),f(w,{key:1,class:"noData"},{default:p((()=>[h(w,null,{default:p((()=>[v("span",{class:"icon iconfont icon-tishi1"})])),_:1}),h(w,null,{default:p((()=>[g("您还没有输入关键字")])),_:1})])),_:1})):(d(),f(w,{key:2,class:"noData"},{default:p((()=>[h(w,null,{default:p((()=>[v("span",{class:"icon iconfont icon-tishi1"})])),_:1}),h(w,null,{default:p((()=>[g("还没有相关的商品哦")])),_:1})])),_:1}))])),_:1}),h(M,{reactionMaterials:a.reactionMaterials,onJiaReaction:a.toCartInsert},null,8,["reactionMaterials","onJiaReaction"])])),_:1})}],["__scopeId","data-v-de77612e"]]);export{S as default};
