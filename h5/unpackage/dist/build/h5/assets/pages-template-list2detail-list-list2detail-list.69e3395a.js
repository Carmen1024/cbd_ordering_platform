import{_ as t,U as a,aV as e,n as s,a as i,c as l,o as n,d as o,w as d,e as r,f as u,t as c,p as h,q as _,F as m,i as f,k as p,h as g}from"./vendor.762bb174.js";import{_ as b}from"./uni-load-more.2a330bc7.js";import{d as v}from"./util.33428444.js";var D=t({data:()=>({banner:{},listData:[],last_id:"",reload:!1,status:"more",adpid:"",contentText:{contentdown:"上拉加载更多",contentrefresh:"加载中",contentnomore:"没有更多"}}),onLoad(){this.adpid=this.$adpid,this.getBanner(),this.getList()},onPullDownRefresh(){this.reload=!0,this.last_id="",this.getBanner(),this.getList()},onReachBottom(){this.status="more",this.getList()},methods:{getBanner(){a({url:"https://unidemo.dcloud.net.cn/api/banner/36kr",data:{column:"id,post_id,title,author_name,cover,published_at"},success:t=>{e(),200==t.statusCode&&(this.banner=t.data)},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},getList(){var t={column:"id,post_id,title,author_name,cover,published_at"};this.last_id&&(this.status="loading",t.minId=this.last_id,t.time=(new Date).getTime()+"",t.pageSize=10),a({url:"https://unidemo.dcloud.net.cn/api/news",data:t,success:t=>{if(200==t.statusCode){let a=this.setTime(t.data);this.listData=this.reload?a:this.listData.concat(a),this.last_id=a[a.length-1].id,this.reload=!1}},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},goDetail:function(t){let a={author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:t.published_at,title:t.title};s({url:"../list2detail-detail/list2detail-detail?detailDate="+encodeURIComponent(JSON.stringify(a))})},setTime:function(t){var a=[];return t.forEach((t=>{a.push({author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:v.format(t.published_at),title:t.title})})),a},aderror(t){console.log("aderror: "+JSON.stringify(t.detail))}}},[["render",function(t,a,e,s,v,D){const x=f,k=p,y=g,C=i(l("uni-load-more"),b);return n(),o(k,null,{default:d((()=>[r(k,{class:"banner",onClick:a[0]||(a[0]=t=>D.goDetail(v.banner))},{default:d((()=>[r(x,{class:"banner-img",src:v.banner.cover},null,8,["src"]),r(k,{class:"banner-title"},{default:d((()=>[u(c(v.banner.title),1)])),_:1})])),_:1}),r(k,{class:"uni-list"},{default:d((()=>[(n(!0),h(m,null,_(v.listData,((t,a)=>(n(),o(k,{key:a,class:"uni-list-cell","hover-class":"uni-list-cell-hover",onClick:a=>D.goDetail(t)},{default:d((()=>[r(k,{class:"uni-media-list"},{default:d((()=>[r(x,{class:"uni-media-list-logo",src:t.cover},null,8,["src"]),r(k,{class:"uni-media-list-body"},{default:d((()=>[r(k,{class:"uni-media-list-text-top"},{default:d((()=>[u(c(t.title),1)])),_:2},1024),r(k,{class:"uni-media-list-text-bottom"},{default:d((()=>[r(y,null,{default:d((()=>[u(c(t.author_name),1)])),_:2},1024),r(y,null,{default:d((()=>[u(c(t.published_at),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),r(C,{status:v.status,"icon-size":16,"content-text":v.contentText},null,8,["status","content-text"])])),_:1})}],["__scopeId","data-v-39e7d5e4"]]);export{D as default};
