import{K as a,_ as s,$ as t,a0 as i,o as e,d as n,w as c,e as l,f as o,N as r,P as d,R as m,T as _,V as u,h as f,k as p,i as h,D as g,F as j,X as y,U as k}from"./vendor.e8d4713a.js";import{l as C}from"./index.d1efd29a.js";import{e as M,f as v}from"./subscribe.d4f37143.js";var D=s(a({props:{reactionMaterials:{type:Object,default:()=>({show:!1,materials:[]})}},computed:{materialData(){return this.reactionMaterials.materials.map((a=>{const s=a.m_prices?a.m_prices[0].m_p_money:0;return console.log(s),a.m_price=(s/100).toFixed(2),a}))}},setup(a){const{s_id:s}=C();return{s_id:s}},methods:{jia(a){console.log(a);const s={m_id:a.r_m_id,m_c_count:a.r_m_count,m_c_unit:1,s_id:this.s_id};this.$emit("jiaReaction",s)}}}),[["render",function(a,s,g,j,y,k){const C=f,M=p,v=h;return t((e(),n(M,{class:"reaction-container"},{default:c((()=>[l(M,{class:"title"},{default:c((()=>[l(C,null,{default:c((()=>[o("关联物料("+r(a.reactionMaterials.materials.length)+")",1)])),_:1}),d("span",{class:"right icon iconfont icon-close",onClick:s[0]||(s[0]=s=>a.reactionMaterials.show=!1)})])),_:1}),l(M,{class:"commodityList"},{default:c((()=>[(e(!0),m(u,null,_(a.materialData,((s,t)=>(e(),n(M,{class:"commodityItem"},{default:c((()=>[l(v,{src:s.img||"/static/logo.jpg"},null,8,["src"]),l(M,{class:"detail"},{default:c((()=>[l(M,{class:"name"},{default:c((()=>[o(r(s.m_name||"物料名称"),1)])),_:2},1024),l(M,{class:"unit"},{default:c((()=>[l(C,{class:"left"},{default:c((()=>[o("500g*30袋/箱")])),_:1}),l(C,{class:"right"},{default:c((()=>[d("span",{class:"icon iconfont icon-jine"}),s.m_prices?(e(),n(C,{key:0},{default:c((()=>[o(r(s.m_price)+"/箱 ",1)])),_:2},1024)):(e(),n(C,{key:1},{default:c((()=>[o("100/箱")])),_:1}))])),_:2},1024)])),_:2},1024),l(M,{class:"price"},{default:c((()=>[l(C,{class:"left total"},{default:c((()=>[o(" 关联件数："+r(s.r_m_count),1)])),_:2},1024),l(M,{class:"right numHandle",onClick:t=>a.jia(s)},{default:c((()=>[d("span",{class:"icon iconfont icon-goumai"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1},512)),[[i,a.reactionMaterials.show]])}],["__scopeId","data-v-7c0e5c46"]]);var $=s(a({props:{materialData:{type:Array,default:()=>[]}},computed:{materialDatas(){return this.materialData.map((a=>{const s=a.m_prices?a.m_prices[0].m_p_money:0;return console.log(s),a.m_price=(s/100).toFixed(2),a}))}},setup:a=>({}),methods:{jia(a){if(a.num>=a.m_stock)return void g({title:"库存已不足",duration:2e3,icon:"none"});if(0==a.c_valid)return void g({title:"物料已失效，无法加购",duration:2e3,icon:"none"});a.num++;const s={m_id:a._id,m_c_count:1,m_c_unit:1,s_id:C().s_id};this.$emit("jiaReaction",s)},jian(a){console.log("减少",a);const s=this;a.num<=1?j({content:"是否确认删除该物料",showCancel:!0,success:function(t){t.confirm&&(a.num--,s.deleteByM(a))}}):(a.num--,s.reduce(a))},reduce(a){const s={m_id:a._id,m_c_count:-1,m_c_unit:1,s_id:C().s_id};this.$emit("jiaReaction",s)},deleteByM(a){const s=this,t={s_id:C().s_id,m_id:a._id};M(t).then((a=>{s.$emit("jianReaction")}))},deleteByIds(a){const s=this;v({ids:a}).then((a=>{g({title:"删除成功",duration:2e3,icon:"none"}),s.$emit("jianReaction")}))},toMaterial(a){}}}),[["render",function(a,s,g,j,C,M){const v=p,D=h,$=f;return e(!0),m(u,null,_(a.materialDatas,((s,m)=>(e(),n(v,{class:"materialItem",onClick:t=>a.toMaterial(s)},{default:c((()=>[s.isFirst||1==s.isFirst?(e(),n(v,{key:0,class:"classify",id:`classify_${s.classifyId}`},{default:c((()=>[o(r(s.classifyName),1)])),_:2},1032,["id"])):y("",!0),l(v,{class:"material"},{default:c((()=>[l(D,{src:s.img||"/static/logo.jpg"},null,8,["src"]),l(v,{class:"detail"},{default:c((()=>[l(v,{class:"name"},{default:c((()=>[o(r(s.m_name||"物料名称"),1)])),_:2},1024),l(v,{class:"unit"},{default:c((()=>[l($,{class:"left"},{default:c((()=>[o(r(s.m_package),1)])),_:2},1024),l($,{class:"right"},{default:c((()=>[d("span",{class:"icon iconfont icon-jine"}),s.m_prices?(e(),n($,{key:0},{default:c((()=>[o(r(s.m_price),1)])),_:2},1024)):(e(),n($,{key:1},{default:c((()=>[o("0.00")])),_:1}))])),_:2},1024)])),_:2},1024),l(v,{class:"price"},{default:c((()=>[l(v,{class:"left total"},{default:c((()=>[o(" 库存量："+r(s.m_stock||999),1)])),_:2},1024),l(v,{class:"right"},{default:c((()=>[t(d("span",{class:"icon iconfont icon-jian",onClick:t=>a.jian(s)},null,8,["onClick"]),[[i,s.num>0]]),l(v,{class:"numHandle",onClick:t=>a.jia(s)},{default:c((()=>[d("span",{class:"icon iconfont icon-goumai"}),s.num&&s.num>0?(e(),n($,{key:0,class:k(s.num>=100?"bigNum":"")},{default:c((()=>[o(r(s.num>=100?"99+":s.num),1)])),_:2},1032,["class"])):y("",!0)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),256)}],["__scopeId","data-v-23b8079a"]]);export{$ as m,D as r};
