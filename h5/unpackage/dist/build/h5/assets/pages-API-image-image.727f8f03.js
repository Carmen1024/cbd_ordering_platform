import{_ as e,ah as s,Z as a,ao as l,R as t,o as i,d as n,w as u,e as c,f as o,F as d,N as r,O as p,Q as f,k as g,aa as h,aV as _,i as m}from"./vendor.a21c6627.js";import{p as y}from"./permission.0399e7a8.js";var I=[["camera"],["album"],["camera","album"]],T=[["compressed"],["original"],["compressed","original"]];var x=e({data:()=>({title:"choose/previewImage",imageList:[],sourceTypeIndex:2,sourceType:["拍照","相册","拍照或相册"],sizeTypeIndex:2,sizeType:["压缩","原图","压缩或原图"],countIndex:8,count:[1,2,3,4,5,6,7,8,9]}),onUnload(){this.imageList=[],this.sourceTypeIndex=2,this.sourceType=["拍照","相册","拍照或相册"],this.sizeTypeIndex=2,this.sizeType=["压缩","原图","压缩或原图"],this.countIndex=8},methods:{sourceTypeChange:function(e){this.sourceTypeIndex=parseInt(e.detail.value)},sizeTypeChange:function(e){this.sizeTypeIndex=parseInt(e.detail.value)},countChange:function(e){this.countIndex=e.detail.value},chooseImage:async function(){if(9===this.imageList.length){let e=await this.isFullImg();if(console.log("是否继续?",e),!e)return}s({sourceType:I[this.sourceTypeIndex],sizeType:T[this.sizeTypeIndex],count:this.imageList.length+this.count[this.countIndex]>9?9-this.imageList.length:this.count[this.countIndex],success:e=>{this.imageList=this.imageList.concat(e.tempFilePaths)},fail:e=>{console.log("err: ",e)}})},isFullImg:function(){return new Promise((e=>{a({content:"已经有9张图片了,是否清空现有图片？",success:s=>{s.confirm?(this.imageList=[],e(!0)):e(!1)},fail:()=>{e(!1)}})}))},previewImage:function(e){var s=e.target.dataset.src;l({current:s,urls:this.imageList})},async checkPermission(e){let s=e?e-1:this.sourceTypeIndex,l=y.isIOS?await y.requestIOS(I[s][0]):await y.requestAndroid(0===s?"android.permission.CAMERA":"android.permission.READ_EXTERNAL_STORAGE");return null===l||1===l?l=1:a({content:"没有开启权限",confirmText:"设置",success:function(e){e.confirm&&y.gotoAppSetting()}}),l}}},[["render",function(e,s,a,l,y,I){const T=t("page-head"),x=g,C=h,v=m,z=_;return i(),n(x,null,{default:u((()=>[c(T,{title:y.title},null,8,["title"]),c(x,{class:"uni-common-mt"},{default:u((()=>[c(z,null,{default:u((()=>[c(x,{class:"uni-list"},{default:u((()=>[c(x,{class:"uni-list-cell"},{default:u((()=>[c(x,{class:"uni-list-cell-left"},{default:u((()=>[c(x,{class:"uni-label"},{default:u((()=>[o("图片来源")])),_:1})])),_:1}),c(x,{class:"uni-list-cell-right"},{default:u((()=>[c(C,{range:y.sourceType,onChange:I.sourceTypeChange,value:y.sourceTypeIndex,mode:"selector"},{default:u((()=>[c(x,{class:"uni-input"},{default:u((()=>[o(d(y.sourceType[y.sourceTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),c(x,{class:"uni-list-cell"},{default:u((()=>[c(x,{class:"uni-list-cell-left"},{default:u((()=>[c(x,{class:"uni-label"},{default:u((()=>[o("图片质量")])),_:1})])),_:1}),c(x,{class:"uni-list-cell-right"},{default:u((()=>[c(C,{range:y.sizeType,onChange:I.sizeTypeChange,value:y.sizeTypeIndex,mode:"selector"},{default:u((()=>[c(x,{class:"uni-input"},{default:u((()=>[o(d(y.sizeType[y.sizeTypeIndex]),1)])),_:1})])),_:1},8,["range","onChange","value"])])),_:1})])),_:1}),c(x,{class:"uni-list-cell"},{default:u((()=>[c(x,{class:"uni-list-cell-left"},{default:u((()=>[c(x,{class:"uni-label"},{default:u((()=>[o("数量限制")])),_:1})])),_:1}),c(x,{class:"uni-list-cell-right"},{default:u((()=>[c(C,{range:y.count,onChange:I.countChange,mode:"selector"},{default:u((()=>[c(x,{class:"uni-input"},{default:u((()=>[o(d(y.count[y.countIndex]),1)])),_:1})])),_:1},8,["range","onChange"])])),_:1})])),_:1})])),_:1}),c(x,{class:"uni-list list-pd"},{default:u((()=>[c(x,{class:"uni-list-cell cell-pd"},{default:u((()=>[c(x,{class:"uni-uploader"},{default:u((()=>[c(x,{class:"uni-uploader-head"},{default:u((()=>[c(x,{class:"uni-uploader-title"},{default:u((()=>[o("点击可预览选好的图片")])),_:1}),c(x,{class:"uni-uploader-info"},{default:u((()=>[o(d(y.imageList.length)+"/9",1)])),_:1})])),_:1}),c(x,{class:"uni-uploader-body"},{default:u((()=>[c(x,{class:"uni-uploader__files"},{default:u((()=>[(i(!0),r(f,null,p(y.imageList,((e,s)=>(i(),n(x,{key:s,class:"uni-uploader__file"},{default:u((()=>[c(v,{class:"uni-uploader__img",src:e,"data-src":e,onClick:I.previewImage},null,8,["src","data-src","onClick"])])),_:2},1024)))),128)),c(x,{class:"uni-uploader__input-box"},{default:u((()=>[c(x,{class:"uni-uploader__input",onClick:I.chooseImage},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-4d7fe987"]]);export{x as default};
