var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,o=(e,o)=>{for(var n in o||(o={}))t.call(o,n)&&l(e,n,o[n]);if(a)for(var n of a(o))s.call(o,n)&&l(e,n,o[n]);return e};import{_ as n,D as i,E as c,a as r,c as d,o as _,d as u,w as f,e as m,K as p,V as h,W as g,M as b,N as k,P as v,f as y,F as D,G as O,h as j,k as w,U as C,O as T,i as I,T as x}from"./vendor.d63b4332.js";import{_ as S}from"./uni-search-bar.de984d73.js";import{_ as N}from"./uni-datetime-picker.63318c9c.js";import{o as P}from"./order.f7fc3fa6.js";import{t as z,s as V}from"./enum.6f7a1015.js";import"./uni-icons.1dd790bb.js";import"./request.f2a0712f.js";import"./token.1631d279.js";var H=n(i({onLoad:function(e){console.log("onLoad"),console.log(e.tabIndex);const a=z.find((a=>a.value==e.tabIndex));a&&this.setTab(a)},onShow:function(){console.log("onShow"),this.getOrderData()},setup(){const e=c([]),a=c({pageSize:20,pageNum:1}),t=c({o_p_code:"",c_create_start_time:"",c_create_end_time:"",o_s_status:[1,2,3,4,5,6,7,8,9,10,11]}),s=c(!0),l=c(1),n=c(["2021-03-20","2021-05-10"]),i=c(!1);return{orderData:e,toOrderDetail:e=>{O({url:"/pages/tabBar/order/detail?_id="+e._id})},getOrderData:()=>{const l=o(o({s_id:"10"},a.value),t.value);P(l).then((t=>{console.log(t);const l=t.data.map((e=>{const a=V.find((a=>a.value===e.o_s_status));return e.o_s_status_desc=a?a.label:e.o_s_status,e}));l.length<a.value.pageSize&&(s.value=!1),e.value=[...e.value,...l],a.value.pageNum++}))},loading:s,tabOptions:z,tabIndex:l,page:a,datetimerange:n,showTime:i,condition:t}},methods:{lower:function(e){console.log(e),this.loading&&this.getOrderData()},checkTab(e){this.setTab(e),this.getOrderData()},setTab(e){this.tabIndex=e.value,this.condition.o_s_status=e.status,this.page.pageNum=1,this.orderData=[]},timeChange(e){console.log(e),0==e.length?(delete this.condition.c_create_start_time,delete this.condition.c_create_end_time):(this.condition.c_create_start_time=e[0]+" 00:00:00",this.condition.c_create_end_time=e[1]+" 23:59:59"),this.page.pageNum=1,this.orderData=[],this.getOrderData()},search(e){console.log(e),0==e.length?delete this.condition.o_p_code:this.condition.o_p_code=e.value,this.page.pageNum=1,this.orderData=[],this.getOrderData()},cancel(){this.condition.o_p_code="",this.page.pageNum=1,this.orderData=[],this.getOrderData()},openPicker(){this.$refs.datetimePicker.show()}}}),[["render",function(e,a,t,s,l,o){const n=r(d("uni-search-bar"),S),i=j,c=w,O=r(d("uni-datetime-picker"),N),P=I,z=x,V=C;return _(),u(c,{class:"order-container"},{default:f((()=>[m(c,{class:"condition"},{default:f((()=>[m(n,{class:"left",onConfirm:e.search,onCancel:e.cancel,radius:"20",maxlength:"30",bgColor:"#fff",placeholder:"请输入订单号查询"},null,8,["onConfirm","onCancel"]),m(i,{class:"right"},{default:f((()=>[p("span",{class:"icon iconfont icon-riqi",onClick:a[0]||(a[0]=a=>e.showTime=!e.showTime)})])),_:1})])),_:1}),h(m(c,{class:"timeMod"},{default:f((()=>[m(O,{ref:"datetimePicker",modelValue:e.datetimerange,"onUpdate:modelValue":a[1]||(a[1]=a=>e.datetimerange=a),type:"daterange",start:"2021-01-01",end:"2022-02-28",rangeSeparator:"至","clear-icon":"",onChange:e.timeChange},null,8,["modelValue","onChange"])])),_:1},512),[[g,e.showTime]]),m(c,{class:"tab"},{default:f((()=>[(_(!0),b(v,null,k(e.tabOptions,(a=>(_(),u(i,{onClick:t=>e.checkTab(a),class:T(e.tabIndex==a.value&&"check")},{default:f((()=>[y(D(a.label),1)])),_:2},1032,["onClick","class"])))),256))])),_:1}),e.orderData.length>0?(_(),u(V,{key:0,class:"right scroll-Y orderData","scroll-y":"true","lower-threshold":"50",onScrolltolower:e.lower},{default:f((()=>[(_(!0),b(v,null,k(e.orderData,((a,t)=>(_(),u(c,null,{default:f((()=>[m(c,{class:"orderItem",onClick:t=>e.toOrderDetail(a)},{default:f((()=>[m(c,{class:"title"},{default:f((()=>[m(i,{class:"left"},{default:f((()=>[y(D(a.o_p_code),1)])),_:2},1024),m(c,{class:"right"},{default:f((()=>[m(i,null,{default:f((()=>[y(D(a.o_s_status_desc),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),m(c,{class:"materialList"},{default:f((()=>[(_(!0),b(v,null,k(a.sub_order_materials,((e,a)=>h((_(),u(c,{class:"materialItem"},{default:f((()=>[m(P,{src:e.img||"/static/logo.jpg"},null,8,["src"]),m(c,{class:"detail"},{default:f((()=>[m(c,{class:"name"},{default:f((()=>[y(D(e.o_m_name||"物料名称"),1)])),_:2},1024),m(c,{class:"price"},{default:f((()=>[m(i,{class:"total"},{default:f((()=>[p("span",{class:"icon iconfont icon-jine"}),y(D(e.o_m_price),1)])),_:2},1024),m(c,{class:"numHandle"},{default:f((()=>[m(i,null,{default:f((()=>[y("x"+D(e.o_m_count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[g,a<3]]))),256)),h(m(c,{class:"more"},{default:f((()=>[y(" 查看更多 "),p("span",{class:"icon iconfont icon-right"})])),_:2},1536),[[g,a.sub_order_materials.length>3]])])),_:2},1024),1==a.o_s_status?(_(),u(c,{key:0,class:"msg"},{default:f((()=>[m(c,{class:"detail"},{default:f((()=>[m(c,{class:"left"},{default:f((()=>[m(i,null,{default:f((()=>[y(D(a.c_create_time),1)])),_:2},1024)])),_:2},1024),m(c,{class:"right"},{default:f((()=>[m(i,null,{default:f((()=>[y("共计："+D(a.s_o_m_num)+"件,",1)])),_:2},1024),m(i,{class:"price"},{default:f((()=>[y("需付款"),p("span",{class:"icon iconfont icon-jine"}),y(D(a.o_p_real_pay_money||0),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),m(c,{class:"numHandle"},{default:f((()=>[m(z,{class:"uni-button",size:"mini"},{default:f((()=>[y("取消订单")])),_:1}),m(z,{type:"primary",size:"mini",onClick:e.submit},{default:f((()=>[y("去付款")])),_:1},8,["onClick"])])),_:1})])),_:2},1024)):(_(),u(c,{key:1,class:"msg"},{default:f((()=>[m(c,{class:"detail"},{default:f((()=>[m(c,{class:"left"},{default:f((()=>[m(i,null,{default:f((()=>[y(D(a.c_create_time),1)])),_:2},1024)])),_:2},1024),m(c,{class:"right"},{default:f((()=>[m(i,null,{default:f((()=>[y("共计："+D(a.s_o_m_num)+"件,",1)])),_:2},1024),m(i,{class:"price"},{default:f((()=>[y("实付款："),p("span",{class:"icon iconfont icon-jine"}),y(D(a.o_p_real_pay_money),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),m(c,{class:"numHandle"},{default:f((()=>[m(z,{size:"mini"},{default:f((()=>[y("再次购买")])),_:1})])),_:1})])),_:2},1024))])),_:2},1032,["onClick"])])),_:2},1024)))),256)),m(c,{class:"loading"},{default:f((()=>[y(D(e.loading?"加载中":"到底喽"),1)])),_:1})])),_:1},8,["onScrolltolower"])):(_(),u(c,{key:1,class:"noData"},{default:f((()=>[m(c,null,{default:f((()=>[p("span",{class:"icon iconfont icon-chargeManagement"})])),_:1}),m(c,null,{default:f((()=>[y("您还没有相关的订单")])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-6ab67db3"]]);export{H as default};
