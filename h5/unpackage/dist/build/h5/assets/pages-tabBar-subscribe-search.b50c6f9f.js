var a=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;import{_ as l}from"./uni-search-bar.de984d73.js";import{_ as n,D as s,E as i,a as c,c as u,Q as m,o as d,d as f,w as h,e as p,f as g,F as _,K as v,k as b,U as y}from"./vendor.d63b4332.js";import{h as w,c as j,a as C}from"./subscribe.6867e227.js";import{m as M,r as S}from"./materialItem.9cf597f6.js";import"./uni-icons.1dd790bb.js";import"./request.f2a0712f.js";import"./token.1631d279.js";var D=n(s({components:{materialItem:M,reaction:S},onShow:function(){this.getCartList()},setup(){const a=i([]);let l=i(""),n={pageSize:20,pageNum:1};const s=i(0),c=i(!0),u=i([]),m=i({show:!1,materials:[]}),d=()=>{u.value=[],C({s_id:"10"}).then((a=>{u.value=a.data||[]}))};return{materialData:a,scrollTop:s,getMaterialQuery:()=>{if(""==(null!=l?l:""))return void(c.value=!1);const s=((a,l)=>{for(var n in l||(l={}))t.call(l,n)&&o(a,n,l[n]);if(e)for(var n of e(l))r.call(l,n)&&o(a,n,l[n]);return a})({r_g_id:"10",s_id:"10",m_name:l.value},n);c.value&&w(s).then((e=>{const t=e.data.map((a=>{const e=u.value.find((e=>e.m_id===a._id));return console.log(e),a.num=e?e.m_c_count:0,a}));t.length<n.pageSize&&(c.value=!1),a.value=[...a.value,...t],n.pageNum++}))},loading:c,page:n,m_name:l,resetSearch:e=>{l.value=e,c.value=!0,n.pageNum=1,a.value=[]},toCartInsert:a=>{j(a).then((a=>{var e;const t=null==(e=a.data)?void 0:e.r_m_material;t&&t.length>0?m.value={materials:t,show:!0}:m.value={materials:[],show:!1},d()}))},reactionMaterials:m,getCartList:d,cartMaterialList:u}},methods:{lower:function(a){console.log(a),this.getMaterialQuery()},search:function(a){console.log("search"),this.resetSearch(a.value),this.getMaterialQuery()},cancel:function(a){this.resetSearch("")}}}),[["render",function(a,e,t,r,o,n){const s=c(u("uni-search-bar"),l),i=m("material-item"),w=b,j=y,C=m("reaction");return d(),f(w,{class:"shopping-container-search"},{default:h((()=>[p(s,{onConfirm:a.search,onCancel:a.cancel,radius:"20",maxlength:"30",bgColor:"#fff",placeholder:"请输入物料名称搜索"},null,8,["onConfirm","onCancel"]),p(w,{class:"shopping-container-main"},{default:h((()=>[a.materialData.length>0?(d(),f(j,{key:0,ref:"materialMod",class:"right scroll-Y materialList","scroll-y":"true","lower-threshold":"50",onScrolltolower:a.lower},{default:h((()=>[p(i,{materialData:a.materialData,onJiaReaction:a.toCartInsert},null,8,["materialData","onJiaReaction"]),p(w,{class:"loading"},{default:h((()=>[g(_(a.loading?"加载中":"到底喽"),1)])),_:1})])),_:1},8,["onScrolltolower"])):""==a.m_name?(d(),f(w,{key:1,class:"noData"},{default:h((()=>[p(w,null,{default:h((()=>[v("span",{class:"icon iconfont icon-tishi1"})])),_:1}),p(w,null,{default:h((()=>[g("您还没有输入关键字")])),_:1})])),_:1})):(d(),f(w,{key:2,class:"noData"},{default:h((()=>[p(w,null,{default:h((()=>[v("span",{class:"icon iconfont icon-tishi1"})])),_:1}),p(w,null,{default:h((()=>[g("还没有相关的商品哦")])),_:1})])),_:1}))])),_:1}),p(C,{reactionMaterials:a.reactionMaterials,onJiaReaction:a.toCartInsert},null,8,["reactionMaterials","onJiaReaction"])])),_:1})}],["__scopeId","data-v-6631386a"]]);export{D as default};
