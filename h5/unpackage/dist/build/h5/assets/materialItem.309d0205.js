import{K as a,_ as s,$ as t,a0 as e,o as i,d as c,w as n,e as l,f as o,N as r,P as m,R as _,T as d,V as u,h as f,k as p,i as h,D as g,F as j,X as y,U as k}from"./vendor.814d7eca.js";import{l as C}from"./index.e1c48d14.js";import{e as M,f as v}from"./subscribe.e187e6ec.js";var D=s(a({props:{reactionMaterials:{type:Object,default:()=>({show:!1,materials:[]})}},computed:{materialData(){return this.reactionMaterials.materials.map((a=>{const s=a.m_prices?a.m_prices[0].m_p_money:0;return console.log(s),a.m_price=(s/100).toFixed(2),a}))}},setup(a){const{s_id:s}=C();return{s_id:s}},methods:{jia(a){console.log(a);const s={m_id:a.r_m_id,m_c_count:a.r_m_count,m_c_unit:1,s_id:this.s_id};this.$emit("jiaReaction",s)}}}),[["render",function(a,s,g,j,y,k){const C=f,M=p,v=h;return t((i(),c(M,{class:"reaction-container"},{default:n((()=>[l(M,{class:"title"},{default:n((()=>[l(C,null,{default:n((()=>[o("关联物料("+r(a.reactionMaterials.materials.length)+")",1)])),_:1}),m("span",{class:"right icon iconfont icon-close",onClick:s[0]||(s[0]=s=>a.reactionMaterials.show=!1)})])),_:1}),l(M,{class:"commodityList"},{default:n((()=>[(i(!0),_(u,null,d(a.materialData,((s,t)=>(i(),c(M,{class:"commodityItem"},{default:n((()=>[l(v,{src:s.img||"/static/logo.jpg"},null,8,["src"]),l(M,{class:"detail"},{default:n((()=>[l(M,{class:"name"},{default:n((()=>[o(r(s.m_name||"物料名称"),1)])),_:2},1024),l(M,{class:"unit"},{default:n((()=>[l(C,{class:"left"},{default:n((()=>[o("500g*30袋/箱")])),_:1}),l(C,{class:"right"},{default:n((()=>[m("span",{class:"icon iconfont icon-jine"}),s.m_prices?(i(),c(C,{key:0},{default:n((()=>[o(r(s.m_price)+"/箱 ",1)])),_:2},1024)):(i(),c(C,{key:1},{default:n((()=>[o("100/箱")])),_:1}))])),_:2},1024)])),_:2},1024),l(M,{class:"price"},{default:n((()=>[l(C,{class:"left total"},{default:n((()=>[o(" 关联件数："+r(s.r_m_count),1)])),_:2},1024),l(M,{class:"right numHandle",onClick:t=>a.jia(s)},{default:n((()=>[m("span",{class:"icon iconfont icon-goumai"})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),256))])),_:1})])),_:1},512)),[[e,a.reactionMaterials.show]])}],["__scopeId","data-v-7c0e5c46"]]);var $=s(a({props:{materialData:{type:Array,default:()=>[]}},computed:{materialDatas(){return this.materialData.map((a=>{const s=a.m_prices?a.m_prices[0].m_p_money:0;return console.log(s),a.m_price=(s/100).toFixed(2),a}))}},setup:a=>({}),methods:{jia(a){if(a.num>=a.m_stock)return void g({title:"库存已不足",duration:2e3,icon:"none"});if(0==a.c_valid)return void g({title:"物料已失效，无法加购",duration:2e3,icon:"none"});a.num++;const s={m_id:a._id,m_c_count:1,m_c_unit:1,s_id:C().s_id};this.$emit("jiaReaction",s)},jian(a){console.log("减少",a);const s=this;a.num<=1?j({content:"是否确认删除该物料",showCancel:!0,success:function(t){t.confirm&&(a.num--,s.deleteByM(a))}}):(a.num--,s.reduce(a))},reduce(a){const s={m_id:a._id,m_c_count:-1,m_c_unit:1,s_id:C().s_id};this.$emit("jiaReaction",s)},deleteByM(a){const s=this,t={s_id:C().s_id,m_id:a._id};M(t).then((a=>{s.$emit("jianReaction")}))},deleteByIds(a){const s=this;v({ids:a}).then((a=>{g({title:"删除成功",duration:2e3,icon:"none"}),s.$emit("jianReaction")}))},toMaterial(a){}}}),[["render",function(a,s,g,j,C,M){const v=p,D=h,$=f;return i(!0),_(u,null,d(a.materialDatas,((s,_)=>(i(),c(v,{class:"materialItem",onClick:t=>a.toMaterial(s)},{default:n((()=>[s.isFirst?(i(),c(v,{key:0,class:"classify",id:`classify_${s.classifyId}`},{default:n((()=>[o(r(s.classifyName),1)])),_:2},1032,["id"])):y("",!0),l(v,{class:"material"},{default:n((()=>[l(D,{src:s.img||"/static/logo.jpg"},null,8,["src"]),l(v,{class:"detail"},{default:n((()=>[l(v,{class:"name"},{default:n((()=>[o(r(s.m_name||"物料名称"),1)])),_:2},1024),l(v,{class:"unit"},{default:n((()=>[l($,{class:"left"},{default:n((()=>[o(r(s.m_package),1)])),_:2},1024),l($,{class:"right"},{default:n((()=>[m("span",{class:"icon iconfont icon-jine"}),s.m_prices?(i(),c($,{key:0},{default:n((()=>[o(r(s.m_price),1)])),_:2},1024)):(i(),c($,{key:1},{default:n((()=>[o("0.00")])),_:1}))])),_:2},1024)])),_:2},1024),l(v,{class:"price"},{default:n((()=>[l(v,{class:"left total"},{default:n((()=>[o(" 库存量："+r(s.m_stock||999),1)])),_:2},1024),l(v,{class:"right"},{default:n((()=>[t(m("span",{class:"icon iconfont icon-jian",onClick:t=>a.jian(s)},null,8,["onClick"]),[[e,s.num>0]]),l(v,{class:"numHandle",onClick:t=>a.jia(s)},{default:n((()=>[m("span",{class:"icon iconfont icon-goumai"}),s.num&&s.num>0?(i(),c($,{key:0,class:k(s.num>=100?"bigNum":"")},{default:n((()=>[o(r(s.num>=100?"99+":s.num),1)])),_:2},1032,["class"])):y("",!0)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),256)}],["__scopeId","data-v-e0d38a38"]]);export{$ as m,D as r};
