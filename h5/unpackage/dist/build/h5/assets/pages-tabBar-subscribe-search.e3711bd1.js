var a=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(e,t,r)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;import{_ as o}from"./uni-search-bar.bd5652da.js";import{_ as n,K as s,M as i,a as c,c as u,W as m,o as d,d as f,w as h,e as p,f as _,N as g,P as v,k as b,Z as y}from"./vendor.e8d4713a.js";import{h as w,c as j,a as C}from"./subscribe.d4f37143.js";import{m as M,r as S}from"./materialItem.ef6c89bb.js";import{l as D}from"./index.d1efd29a.js";import"./uni-icons.86ca88fe.js";var I=n(s({components:{materialItem:M,reaction:S},onShow:function(){this.getCartList()},setup(){const a=i([]);let o=i(""),n={pageSize:20,pageNum:1};const s=i(0),c=i(!0),u=i([]),m=i({show:!1,materials:[]}),d=()=>{u.value=[],C({s_id:D().s_id}).then((a=>{u.value=a.data||[]}))};return{materialData:a,scrollTop:s,getMaterialQuery:()=>{if(""==(null!=o?o:""))return void(c.value=!1);const s=((a,o)=>{for(var n in o||(o={}))t.call(o,n)&&l(a,n,o[n]);if(e)for(var n of e(o))r.call(o,n)&&l(a,n,o[n]);return a})({r_g_id:D().r_g_id,s_id:D().s_id,m_name:o.value},n);c.value&&w(s).then((e=>{const t=e.data.map((a=>{const e=u.value.find((e=>e.m_id===a._id));return console.log(e),a.num=e?e.m_c_count:0,a}));t.length<n.pageSize&&(c.value=!1),a.value=[...a.value,...t],n.pageNum++}))},loading:c,page:n,m_name:o,resetSearch:e=>{o.value=e,c.value=!0,n.pageNum=1,a.value=[]},toCartInsert:a=>{j(a).then((a=>{var e;const t=null==(e=a.data)?void 0:e.r_m_material;t&&t.length>0?m.value={materials:t,show:!0}:m.value={materials:[],show:!1},d()}))},reactionMaterials:m,getCartList:d,cartMaterialList:u}},methods:{lower:function(a){console.log(a),this.getMaterialQuery()},search:function(a){console.log("search"),this.resetSearch(a.value),this.getMaterialQuery()},cancel:function(a){this.resetSearch("")}}}),[["render",function(a,e,t,r,l,n){const s=c(u("uni-search-bar"),o),i=m("material-item"),w=b,j=y,C=m("reaction");return d(),f(w,{class:"shopping-container-search"},{default:h((()=>[p(s,{onConfirm:a.search,onCancel:a.cancel,radius:"20",maxlength:"30",bgColor:"#fff",placeholder:"请输入物料名称搜索"},null,8,["onConfirm","onCancel"]),p(w,{class:"shopping-container-main"},{default:h((()=>[a.materialData.length>0?(d(),f(j,{key:0,ref:"materialMod",class:"right scroll-Y materialList","scroll-y":"true","lower-threshold":"50",onScrolltolower:a.lower},{default:h((()=>[p(i,{materialData:a.materialData,onJiaReaction:a.toCartInsert},null,8,["materialData","onJiaReaction"]),p(w,{class:"loading"},{default:h((()=>[_(g(a.loading?"加载中":"到底喽"),1)])),_:1})])),_:1},8,["onScrolltolower"])):""==a.m_name?(d(),f(w,{key:1,class:"noData"},{default:h((()=>[p(w,null,{default:h((()=>[v("span",{class:"icon iconfont icon-tishi1"})])),_:1}),p(w,null,{default:h((()=>[_("您还没有输入关键字")])),_:1})])),_:1})):(d(),f(w,{key:2,class:"noData"},{default:h((()=>[p(w,null,{default:h((()=>[v("span",{class:"icon iconfont icon-tishi1"})])),_:1}),p(w,null,{default:h((()=>[_("还没有相关的商品哦")])),_:1})])),_:1}))])),_:1}),p(C,{reactionMaterials:a.reactionMaterials,onJiaReaction:a.toCartInsert},null,8,["reactionMaterials","onJiaReaction"])])),_:1})}],["__scopeId","data-v-0337df28"]]);export{I as default};
