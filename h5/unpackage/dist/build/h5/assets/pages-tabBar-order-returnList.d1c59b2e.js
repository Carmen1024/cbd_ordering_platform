var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,o=(e,o)=>{for(var n in o||(o={}))t.call(o,n)&&l(e,n,o[n]);if(a)for(var n of a(o))s.call(o,n)&&l(e,n,o[n]);return e};import{_ as n,K as i,M as r,a as c,c as d,o as _,d as u,w as f,e as m,P as p,$ as g,a0 as h,R as b,T as y,V as w,f as v,N as j,C as k,h as D,k as C,Z as O,i as S,Y as P}from"./vendor.814d7eca.js";import{_ as T}from"./uni-search-bar.b90e4e05.js";import{_ as M}from"./uni-datetime-picker.3dbb0f5f.js";import{o as N}from"./order.6e4112aa.js";import{s as x}from"./enum.bdbcf073.js";import{l as z,t as I}from"./index.e1c48d14.js";import"./uni-icons.e57e5a6e.js";var H=n(i({onShow:function(){console.log("onShow"),this.getOrderData()},setup(){const e=r([]),{s_id:a,r_g_id:t}=z(),s=r({pageSize:20,pageNum:1}),l=r({o_p_code:"",c_create_start_time:"",c_create_end_time:"",o_s_status:[8,9,10,11]}),n=r(!0),i=r([]),c=I(new Date,"yyyy-MM-dd"),d=r(!1);return{orderData:e,toOrderDetail:e=>{k({url:"/pages/tabBar/order/detail?_id="+e._id})},getOrderData:()=>{const t=o(o({s_id:a},s.value),l.value);N(t).then((a=>{console.log(a);const t=a.data.map((e=>{const a=x.find((a=>a.value===e.o_s_status));return e.o_s_status_desc=a?a.label:e.o_s_status,e}));t.length<s.value.pageSize&&(n.value=!1),e.value=[...e.value,...t],s.value.pageNum++}))},loading:n,page:s,datetimerange:i,nowTime:c,showTime:d,condition:l}},methods:{lower:function(e){console.log(e),this.loading&&this.getOrderData()},timeChange(e){console.log(e),0==e.length?(delete this.condition.c_create_start_time,delete this.condition.c_create_end_time):(this.condition.c_create_start_time=e[0]+" 00:00:00",this.condition.c_create_end_time=e[1]+" 23:59:59"),this.page.pageNum=1,this.orderData=[],this.getOrderData()},search(e){console.log(e),0==e.length?delete this.condition.o_p_code:this.condition.o_p_code=e.value,this.page.pageNum=1,this.orderData=[],this.getOrderData()},openPicker(){this.$refs.datetimePicker.show()}}}),[["render",function(e,a,t,s,l,o){const n=c(d("uni-search-bar"),T),i=D,r=C,k=c(d("uni-datetime-picker"),M),N=S,x=P,z=O;return _(),u(r,{class:"order-container"},{default:f((()=>[m(r,{class:"condition"},{default:f((()=>[m(n,{class:"left",onConfirm:e.search,radius:"20",maxlength:"30",bgColor:"#fff",placeholder:"请输入订单号查询"},null,8,["onConfirm"]),m(i,{class:"right"},{default:f((()=>[p("span",{class:"icon iconfont icon-riqi",onClick:a[0]||(a[0]=a=>e.showTime=!e.showTime)})])),_:1})])),_:1}),g(m(r,{class:"timeMod"},{default:f((()=>[m(k,{ref:"datetimePicker",type:"daterange",value:e.datetimerange,end:e.nowTime,rangeSeparator:"至","clear-icon":"",onChange:e.timeChange},null,8,["value","end","onChange"])])),_:1},512),[[h,e.showTime]]),e.orderData.length>0?(_(),u(z,{key:0,class:"right scroll-Y orderData","scroll-y":"true","lower-threshold":"50",onScrolltolower:e.lower},{default:f((()=>[(_(!0),b(w,null,y(e.orderData,((a,t)=>(_(),u(r,null,{default:f((()=>[m(r,{class:"orderItem",onClick:t=>e.toOrderDetail(a)},{default:f((()=>[m(r,{class:"title"},{default:f((()=>[m(i,{class:"left"},{default:f((()=>[v("订单号："+j(a.o_p_code),1)])),_:2},1024),m(r,{class:"right"},{default:f((()=>[m(i,null,{default:f((()=>[v(j(a.o_s_status_desc),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),m(r,{class:"materialList"},{default:f((()=>[(_(!0),b(w,null,y(a.sub_order_materials,((e,a)=>g((_(),u(r,{class:"materialItem"},{default:f((()=>[m(N,{src:e.img||"/static/logo.jpg"},null,8,["src"]),m(r,{class:"detail"},{default:f((()=>[m(r,{class:"name"},{default:f((()=>[v(j(e.o_m_name||"物料名称"),1)])),_:2},1024),m(r,{class:"price"},{default:f((()=>[m(i,{class:"total"},{default:f((()=>[p("span",{class:"icon iconfont icon-jine"}),v(j(e.o_m_price),1)])),_:2},1024),m(r,{class:"numHandle"},{default:f((()=>[m(i,null,{default:f((()=>[v("x"+j(e.o_m_count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[h,a<3]]))),256)),g(m(r,{class:"more"},{default:f((()=>[v(" 查看更多 "),p("span",{class:"icon iconfont icon-right"})])),_:2},1536),[[h,a.sub_order_materials.length>3]])])),_:2},1024),1==a.o_s_status?(_(),u(r,{key:0,class:"msg"},{default:f((()=>[m(r,{class:"detail"},{default:f((()=>[m(r,{class:"left"},{default:f((()=>[m(i,null,{default:f((()=>[v(j(a.c_create_time),1)])),_:2},1024)])),_:2},1024),m(r,{class:"right"},{default:f((()=>[m(i,null,{default:f((()=>[v("共计："+j(a.s_o_m_num)+"件,",1)])),_:2},1024),m(i,{class:"price"},{default:f((()=>[v("需付款"),p("span",{class:"icon iconfont icon-jine"}),v(j(a.o_p_real_pay_money||0),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),m(r,{class:"numHandle"},{default:f((()=>[m(x,{class:"uni-button",size:"mini"},{default:f((()=>[v("取消订单")])),_:1}),m(x,{type:"primary",size:"mini",onClick:e.submit},{default:f((()=>[v("去付款")])),_:1},8,["onClick"])])),_:1})])),_:2},1024)):(_(),u(r,{key:1,class:"msg"},{default:f((()=>[m(r,{class:"detail"},{default:f((()=>[m(r,{class:"left"},{default:f((()=>[m(i,null,{default:f((()=>[v(j(a.c_create_time),1)])),_:2},1024)])),_:2},1024),m(r,{class:"right"},{default:f((()=>[m(i,null,{default:f((()=>[v("共计："+j(a.s_o_m_num)+"件,",1)])),_:2},1024),m(i,{class:"price"},{default:f((()=>[v("实付款："),p("span",{class:"icon iconfont icon-jine"}),v(j(a.o_p_real_pay_money),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024))])),_:2},1032,["onClick"])])),_:2},1024)))),256)),m(r,{class:"loading"},{default:f((()=>[v(j(e.loading?"加载中":"到底喽"),1)])),_:1})])),_:1},8,["onScrolltolower"])):(_(),u(r,{key:1,class:"noData"},{default:f((()=>[m(r,null,{default:f((()=>[p("span",{class:"icon iconfont icon-chargeManagement"})])),_:1}),m(r,null,{default:f((()=>[v("您还没有相关的订单")])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-33d31bc0"]]);export{H as default};
