var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,l=(e,l)=>{for(var n in l||(l={}))t.call(l,n)&&o(e,n,l[n]);if(a)for(var n of a(l))s.call(l,n)&&o(e,n,l[n]);return e};import{K as n,_ as i,o as r,d as c,w as d,R as u,T as _,$ as m,a0 as f,e as h,f as p,N as g,P as b,V as v,i as y,k as O,h as w,M as D,a as j,c as k,W as C,C as T,Z as x,U as I}from"./vendor.814d7eca.js";import{_ as P}from"./uni-search-bar.b90e4e05.js";import{_ as N}from"./uni-datetime-picker.3dbb0f5f.js";import{o as S}from"./order.6e4112aa.js";import{t as M,s as B}from"./enum.bdbcf073.js";import{O as L}from"./oButton.85e87548.js";import{t as R,l as z}from"./index.e1c48d14.js";import"./uni-icons.e57e5a6e.js";import"./payButton.f6224ea8.js";const F=n({props:{materials:{type:Array,default:()=>[]}},setup:e=>({})});var $=i(n({components:{OButton:L,OMaterial:i(F,[["render",function(e,a,t,s,o,l){const n=y,i=O,D=w;return r(),c(i,{class:"materialList"},{default:d((()=>[(r(!0),u(v,null,_(e.materials,((a,t)=>m((r(),c(i,{class:"materialItem"},{default:d((()=>[h(n,{src:a.img||"/static/logo.jpg"},null,8,["src"]),h(i,{class:"detail"},{default:d((()=>[h(i,{class:"name"},{default:d((()=>[p(g(a.o_m_name||"物料名称"),1)])),_:2},1024),h(i,{class:"price"},{default:d((()=>[h(D,{class:"total"},{default:d((()=>[b("span",{class:"icon iconfont icon-jine"}),p(g((a.o_m_price/100).toFixed(2)),1)])),_:2},1024),h(i,{class:"numHandle"},{default:d((()=>[h(D,null,{default:d((()=>[p("x"+g(a.o_m_count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[f,e.materials.length>0&&t<3]]))),256)),m(h(i,{class:"more"},{default:d((()=>[p(" 查看更多 "),b("span",{class:"icon iconfont icon-right"})])),_:1},512),[[f,e.materials.length>3]])])),_:1})}],["__scopeId","data-v-43714b11"]])},onLoad:function(e){console.log("onLoad"),console.log(e.tabIndex);const a=M.find((a=>a.value==e.tabIndex));a&&this.setTab(a)},onShow:function(){console.log("onShow"),this.resetPage()},setup(){const e=D([]),a=D({pageSize:20,pageNum:1}),t=D({o_p_code:"",c_create_start_time:"",c_create_end_time:""}),s=D(!0),o=D(1),n=D([]),i=R(new Date,"yyyy-MM-dd"),r=D(!1);return{orderData:e,toOrderDetail:e=>{T({url:"/pages/tabBar/order/detail?_id="+e._id})},getOrderData:()=>{const o=z().s_id,n=l(l({s_id:o},a.value),t.value);S(n).then((t=>{console.log(t);const l=t.data.map((e=>{const a=B.find((a=>a.value===e.o_s_status));return e.o_s_status_desc=a?a.label:e.o_s_status,e}));l.length<a.value.pageSize&&(s.value=!1),e.value=1==a.value.pageNum?l:[...e.value,...l],a.value.pageNum++,console.log("s_id：",o)}))},loading:s,tabOptions:M,tabIndex:o,page:a,datetimerange:n,nowTime:i,showTime:r,condition:t}},methods:{lower:function(e){console.log(e),this.loading&&this.getOrderData()},checkTab(e){this.setTab(e),this.getOrderData()},setTab(e){this.tabIndex=e.value,this.condition.o_s_status=e.status,this.page.pageNum=1,this.orderData=[]},timeChange(e){console.log(e),0==e.length?(delete this.condition.c_create_start_time,delete this.condition.c_create_end_time):(this.condition.c_create_start_time=e[0]+" 00:00:00",this.condition.c_create_end_time=e[1]+" 23:59:59"),this.page.pageNum=1,this.orderData=[],this.getOrderData()},search(e){console.log(e),0==e.length?delete this.condition.o_p_code:this.condition.o_p_code=e.value,this.page.pageNum=1,this.orderData=[],this.getOrderData()},cancel(){this.condition.o_p_code="",this.page.pageNum=1,this.orderData=[],this.getOrderData()},openPicker(){this.$refs.datetimePicker.show()},resetPage(){this.page.pageNum=1,this.condition.o_p_code="",this.condition.c_create_start_time="",this.condition.c_create_end_time="",this.getOrderData()}}}),[["render",function(e,a,t,s,o,l){const n=j(k("uni-search-bar"),P),i=w,y=O,D=j(k("uni-datetime-picker"),N),T=C("o-material"),S=C("o-button"),M=x;return r(),c(y,{class:"order-container"},{default:d((()=>[h(y,{class:"condition"},{default:d((()=>[h(n,{class:"left",onConfirm:e.search,onCancel:e.cancel,radius:"20",maxlength:"30",bgColor:"#fff",placeholder:"请输入订单号查询"},null,8,["onConfirm","onCancel"]),h(i,{class:"right"},{default:d((()=>[b("span",{class:"icon iconfont icon-riqi",onClick:a[0]||(a[0]=a=>e.showTime=!e.showTime)})])),_:1})])),_:1}),m(h(y,{class:"timeMod"},{default:d((()=>[h(D,{ref:"datetimePicker",type:"daterange",value:e.datetimerange,end:e.nowTime,rangeSeparator:"至","clear-icon":"",onChange:e.timeChange},null,8,["value","end","onChange"])])),_:1},512),[[f,e.showTime]]),h(y,{class:"tab"},{default:d((()=>[(r(!0),u(v,null,_(e.tabOptions,(a=>(r(),c(i,{onClick:t=>e.checkTab(a),class:I(e.tabIndex==a.value&&"check")},{default:d((()=>[p(g(a.label),1)])),_:2},1032,["onClick","class"])))),256))])),_:1}),e.orderData.length>0?(r(),c(M,{key:0,class:"right scroll-Y orderData","scroll-y":"true","lower-threshold":"50",onScrolltolower:e.lower},{default:d((()=>[(r(!0),u(v,null,_(e.orderData,((a,t)=>(r(),c(y,null,{default:d((()=>[h(y,{class:"orderItem"},{default:d((()=>[h(y,{onClick:t=>e.toOrderDetail(a)},{default:d((()=>[h(y,{class:"title"},{default:d((()=>[h(i,{class:"left"},{default:d((()=>[p("订单号："+g(a.o_p_code),1)])),_:2},1024),h(y,{class:"right"},{default:d((()=>[h(i,null,{default:d((()=>[p(g(a.o_s_status_desc),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),h(T,{materials:a.sub_order_materials},null,8,["materials"]),h(y,{class:"msg"},{default:d((()=>[h(y,{class:"detail"},{default:d((()=>[h(y,{class:"left"},{default:d((()=>[h(i,null,{default:d((()=>[p(g(a.c_create_time),1)])),_:2},1024)])),_:2},1024),h(y,{class:"right"},{default:d((()=>[h(i,null,{default:d((()=>[p("共计："+g(a.s_o_m_num)+"件,",1)])),_:2},1024),h(i,{class:"price"},{default:d((()=>[p(g(1==a.o_s_status?"需付款":"实付款")+"：",1),b("span",{class:"icon iconfont icon-jine"}),p(g((a.o_p_real_pay_money/100).toFixed(2)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),h(S,{order:a,onRefresh:e.resetPage},null,8,["order","onRefresh"])])),_:2},1024)])),_:2},1024)))),256)),h(y,{class:"loading"},{default:d((()=>[p(g(e.loading?"加载中":"到底喽"),1)])),_:1})])),_:1},8,["onScrolltolower"])):(r(),c(y,{key:1,class:"noData"},{default:d((()=>[h(y,null,{default:d((()=>[b("span",{class:"icon iconfont icon-chargeManagement"})])),_:1}),h(y,null,{default:d((()=>[p("您还没有相关的订单")])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-08955a24"]]);export{$ as default};
