var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,l=(e,l)=>{for(var n in l||(l={}))t.call(l,n)&&o(e,n,l[n]);if(a)for(var n of a(l))s.call(l,n)&&o(e,n,l[n]);return e};import{D as n,_ as r,o as i,d as c,w as d,N as u,O as _,W as m,X as f,e as p,f as h,F as g,L as b,Q as v,i as O,k as D,h as j,E as k,a as w,c as y,R as C,G as I,V as P,P as N}from"./vendor.a21c6627.js";import{_ as T}from"./uni-search-bar.24f13762.js";import{_ as x}from"./uni-datetime-picker.fd10993b.js";import{o as S}from"./order.84a9170d.js";import{t as B,s as L}from"./enum.bdbcf073.js";import{O as V}from"./oButton.96d0d0c5.js";import"./uni-icons.a51ab7af.js";import"./request.bd165be5.js";import"./token.ba774510.js";import"./payButton.f50aa180.js";const M=n({props:{materials:{type:Array,default:()=>[]}},setup:e=>({})});var R=r(n({components:{OButton:V,OMaterial:r(M,[["render",function(e,a,t,s,o,l){const n=O,r=D,k=j;return i(),c(r,{class:"materialList"},{default:d((()=>[(i(!0),u(v,null,_(e.materials,((a,t)=>m((i(),c(r,{class:"materialItem"},{default:d((()=>[p(n,{src:a.img||"/static/logo.jpg"},null,8,["src"]),p(r,{class:"detail"},{default:d((()=>[p(r,{class:"name"},{default:d((()=>[h(g(a.o_m_name||"物料名称"),1)])),_:2},1024),p(r,{class:"price"},{default:d((()=>[p(k,{class:"total"},{default:d((()=>[b("span",{class:"icon iconfont icon-jine"}),h(g(a.o_m_price),1)])),_:2},1024),p(r,{class:"numHandle"},{default:d((()=>[p(k,null,{default:d((()=>[h("x"+g(a.o_m_count),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[f,e.materials.length>0&&t<3]]))),256)),m(p(r,{class:"more"},{default:d((()=>[h(" 查看更多 "),b("span",{class:"icon iconfont icon-right"})])),_:1},512),[[f,e.materials.length>3]])])),_:1})}],["__scopeId","data-v-30e84f9a"]])},onLoad:function(e){console.log("onLoad"),console.log(e.tabIndex);const a=B.find((a=>a.value==e.tabIndex));a&&this.setTab(a)},onShow:function(){console.log("onShow"),this.resetPage()},setup(){const e=k([]),a=k({pageSize:20,pageNum:1}),t=k({o_p_code:"",c_create_start_time:"",c_create_end_time:""}),s=k(!0),o=k(1),n=k(["2021-03-20","2021-05-10"]),r=k(!1);return{orderData:e,toOrderDetail:e=>{I({url:"/pages/tabBar/order/detail?_id="+e._id})},getOrderData:()=>{const o=l(l({s_id:"10"},a.value),t.value);S(o).then((t=>{console.log(t);const o=t.data.map((e=>{const a=L.find((a=>a.value===e.o_s_status));return e.o_s_status_desc=a?a.label:e.o_s_status,e}));o.length<a.value.pageSize&&(s.value=!1),e.value=1==a.value.pageNum?o:[...e.value,...o],a.value.pageNum++}))},loading:s,tabOptions:B,tabIndex:o,page:a,datetimerange:n,showTime:r,condition:t}},methods:{lower:function(e){console.log(e),this.loading&&this.getOrderData()},checkTab(e){this.setTab(e),this.getOrderData()},setTab(e){this.tabIndex=e.value,this.condition.o_s_status=e.status,this.page.pageNum=1,this.orderData=[]},timeChange(e){console.log(e),0==e.length?(delete this.condition.c_create_start_time,delete this.condition.c_create_end_time):(this.condition.c_create_start_time=e[0]+" 00:00:00",this.condition.c_create_end_time=e[1]+" 23:59:59"),this.page.pageNum=1,this.orderData=[],this.getOrderData()},search(e){console.log(e),0==e.length?delete this.condition.o_p_code:this.condition.o_p_code=e.value,this.page.pageNum=1,this.orderData=[],this.getOrderData()},cancel(){this.condition.o_p_code="",this.page.pageNum=1,this.orderData=[],this.getOrderData()},openPicker(){this.$refs.datetimePicker.show()},resetPage(){this.page.pageNum=1,this.condition.o_p_code="",this.condition.c_create_start_time="",this.condition.c_create_end_time="",this.getOrderData()}}}),[["render",function(e,a,t,s,o,l){const n=w(y("uni-search-bar"),T),r=j,O=D,k=w(y("uni-datetime-picker"),x),I=C("o-material"),S=C("o-button"),B=P;return i(),c(O,{class:"order-container"},{default:d((()=>[p(O,{class:"condition"},{default:d((()=>[p(n,{class:"left",onConfirm:e.search,onCancel:e.cancel,radius:"20",maxlength:"30",bgColor:"#fff",placeholder:"请输入订单号查询"},null,8,["onConfirm","onCancel"]),p(r,{class:"right"},{default:d((()=>[b("span",{class:"icon iconfont icon-riqi",onClick:a[0]||(a[0]=a=>e.showTime=!e.showTime)})])),_:1})])),_:1}),m(p(O,{class:"timeMod"},{default:d((()=>[p(k,{ref:"datetimePicker",modelValue:e.datetimerange,"onUpdate:modelValue":a[1]||(a[1]=a=>e.datetimerange=a),type:"daterange",start:"2021-01-01",end:"2022-02-28",rangeSeparator:"至","clear-icon":"",onChange:e.timeChange},null,8,["modelValue","onChange"])])),_:1},512),[[f,e.showTime]]),p(O,{class:"tab"},{default:d((()=>[(i(!0),u(v,null,_(e.tabOptions,(a=>(i(),c(r,{onClick:t=>e.checkTab(a),class:N(e.tabIndex==a.value&&"check")},{default:d((()=>[h(g(a.label),1)])),_:2},1032,["onClick","class"])))),256))])),_:1}),e.orderData.length>0?(i(),c(B,{key:0,class:"right scroll-Y orderData","scroll-y":"true","lower-threshold":"50",onScrolltolower:e.lower},{default:d((()=>[(i(!0),u(v,null,_(e.orderData,((a,t)=>(i(),c(O,null,{default:d((()=>[p(O,{class:"orderItem"},{default:d((()=>[p(O,{onClick:t=>e.toOrderDetail(a)},{default:d((()=>[p(O,{class:"title"},{default:d((()=>[p(r,{class:"left"},{default:d((()=>[h(g(a.o_p_code),1)])),_:2},1024),p(O,{class:"right"},{default:d((()=>[p(r,null,{default:d((()=>[h(g(a.o_s_status_desc),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(I,{materials:a.sub_order_materials},null,8,["materials"]),p(O,{class:"msg"},{default:d((()=>[p(O,{class:"detail"},{default:d((()=>[p(O,{class:"left"},{default:d((()=>[p(r,null,{default:d((()=>[h(g(a.c_create_time),1)])),_:2},1024)])),_:2},1024),p(O,{class:"right"},{default:d((()=>[p(r,null,{default:d((()=>[h("共计："+g(a.s_o_m_num)+"件,",1)])),_:2},1024),p(r,{class:"price"},{default:d((()=>[h(g(1==a.o_s_status?"需付款":"实付款")+"：",1),b("span",{class:"icon iconfont icon-jine"}),h(g(a.o_p_real_pay_money),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"]),p(S,{order:a,onRefresh:e.resetPage},null,8,["order","onRefresh"])])),_:2},1024)])),_:2},1024)))),256)),p(O,{class:"loading"},{default:d((()=>[h(g(e.loading?"加载中":"到底喽"),1)])),_:1})])),_:1},8,["onScrolltolower"])):(i(),c(O,{key:1,class:"noData"},{default:d((()=>[p(O,null,{default:d((()=>[b("span",{class:"icon iconfont icon-chargeManagement"})])),_:1}),p(O,null,{default:d((()=>[h("您还没有相关的订单")])),_:1})])),_:1}))])),_:1})}],["__scopeId","data-v-dea8958c"]]);export{R as default};
