import{_ as t,be as e,a1 as o,au as i,a as n,c as a,o as s,d as u,w as c,e as l,f as p,m as r,t as d,k as f,h as m,D as h}from"./vendor.1f020a26.js";import{a as g}from"./index.1e1ef7c1.js";import{_}from"./uni-popup.309882f2.js";import{a as y}from"./util.33428444.js";import"./uni-transition.d17fff5c.js";var L=y;var S=t({data:()=>({title:"getLocation",hasLocation:!1,location:{},type:""}),methods:{togglePopup(t){this.type=t},showConfirm(){this.type="showpopup"},hideConfirm(){this.type=""},async getLocation(){this.doGetLocation()},doGetLocation(){e({success:t=>{this.hasLocation=!0,this.location=L(t.longitude,t.latitude)},fail:t=>{t.errMsg.indexOf("auth deny")>=0?o({title:"访问位置被拒绝"}):o({title:t.errMsg})}})},getSetting:function(){return new Promise(((t,e)=>{uni.getSetting({success:e=>{void 0!==e.authSetting["scope.userLocation"]?e.authSetting["scope.userLocation"]?t(1):t(2):t(0)}})}))},openSetting:function(){this.hideConfirm(),uni.openSetting({success:t=>{t.authSetting&&t.authSetting["scope.userLocation"]&&this.doGetLocation()},fail:t=>{}})},async checkPermission(){let t=permision.isIOS?await permision.requestIOS("location"):await permision.requestAndroid("android.permission.ACCESS_FINE_LOCATION");return null===t||1===t?t=1:2===t?i({content:"系统定位已关闭",confirmText:"确定",showCancel:!1,success:function(t){}}):t.code?i({content:t.message}):i({content:"需要定位权限",confirmText:"设置",success:function(t){t.confirm&&permision.gotoAppSetting()}}),t},clear:function(){this.hasLocation=!1}}},[["render",function(t,e,o,i,y,L){const S=n(a("page-head"),g),C=f,k=m,w=h,x=n(a("uni-popup"),_);return s(),u(C,null,{default:c((()=>[l(S,{title:y.title},null,8,["title"]),l(C,{class:"uni-padding-wrap"},{default:c((()=>[l(C,{style:{background:"#FFFFFF",padding:"40rpx"}},{default:c((()=>[l(C,{class:"uni-hello-text uni-center"},{default:c((()=>[p("当前位置经纬度")])),_:1}),!1===y.hasLocation?(s(),u(C,{key:0,class:"uni-h2 uni-center uni-common-mt"},{default:c((()=>[p("未获取")])),_:1})):r("",!0),!0===y.hasLocation?(s(),u(C,{key:1,class:"uni-h2 uni-center uni-common-mt"},{default:c((()=>[l(k,null,{default:c((()=>[p("E: "+d(y.location.longitude[0])+"°"+d(y.location.longitude[1])+"′",1)])),_:1}),l(k,null,{default:c((()=>[p("\\nN: "+d(y.location.latitude[0])+"°"+d(y.location.latitude[1])+"′",1)])),_:1})])),_:1})):r("",!0)])),_:1}),l(C,{class:"uni-btn-v"},{default:c((()=>[l(w,{type:"primary",onClick:L.getLocation},{default:c((()=>[p("获取位置")])),_:1},8,["onClick"]),l(w,{onClick:L.clear},{default:c((()=>[p("清空")])),_:1},8,["onClick"])])),_:1})])),_:1}),l(x,{show:"showpopup"===y.type,mode:"fixed",onHidePopup:e[1]||(e[1]=t=>L.togglePopup(""))},{default:c((()=>[l(C,{class:"popup-view"},{default:c((()=>[l(k,{class:"popup-title"},{default:c((()=>[p("需要用户授权位置权限")])),_:1}),l(C,{class:"uni-flex popup-buttons"},{default:c((()=>[l(w,{class:"uni-flex-item",type:"primary","open-type":"openSetting",onClick:L.openSetting},{default:c((()=>[p("设置")])),_:1},8,["onClick"]),l(w,{class:"uni-flex-item",onClick:e[0]||(e[0]=t=>L.togglePopup(""))},{default:c((()=>[p("取消")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})}],["__scopeId","data-v-5ea2441c"]]);export{S as default};
